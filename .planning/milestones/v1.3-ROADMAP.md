# Milestone v1.3: Broma Bakery Import

**Status:** SHIPPED 2026-01-19
**Phases:** 16-22.1
**Total Plans:** 14

## Overview

Scrape recipes from Broma Bakery (Cookies, Bars, Muffins, Brownies) and import via JSON into the food app with proper markdown formatting. Add recipe images and paste URL feature.

## Phases

### Phase 16: Scraping Infrastructure

**Goal**: Test scrape one recipe, validate JSON format works with import system
**Depends on**: Phase 15
**Research**: Likely (recipe page structure, ingredient parsing patterns)
**Plans**: 2 plans

Plans:
- [x] 16-01: Test Scrape & Format
- [x] 16-02: Ingredient Category Mapping

**Details:**
- Established WebFetch extraction pattern for recipe pages
- Created JSON import format with version, meals array, isBaking flag
- PowerShell clipboard workflow for JSON copy
- Ingredient category mapping reference for batch processing

### Phase 17: Cookies Batch

**Goal**: Scrape all 27 cookie recipes, generate import-ready JSON
**Depends on**: Phase 16
**Research**: Unlikely (pattern established)
**Plans**: 2 plans

Plans:
- [x] 17-01: Scrape Cookies
- [x] 17-02: Generate JSON

**Details:**
- Scraped 27 cookie recipes in 3 batches
- Generated cookies-import.json with proper markdown formatting
- Created cookies-images.json with image URL mappings

### Phase 18: Bars Batch

**Goal**: Scrape bar recipes (36 of 71 found), extract image URLs, generate import-ready JSON
**Depends on**: Phase 16
**Research**: Unlikely (pattern established)
**Plans**: 2 plans

Plans:
- [x] 18-01: Scrape Bars
- [x] 18-02: Generate JSON + Images

**Details:**
- Scraped 36 bar recipes (first half of 71 total)
- Generated bars-import.json with proper markdown formatting
- Created bars-images.json with image URL mappings

### Phase 19: Muffins Batch

**Goal**: Scrape all 18 muffin recipes, extract image URLs, generate import-ready JSON
**Depends on**: Phase 16
**Research**: Unlikely (pattern established)
**Plans**: 2 plans

Plans:
- [x] 19-01: Scrape Muffins
- [x] 19-02: Generate JSON + Images

**Details:**
- Scraped 21 muffin recipes (exceeded 18 estimate)
- Generated muffins-import.json with proper markdown formatting
- Created muffins-images.json with image URL mappings

### Phase 20: Brownies Batch

**Goal**: Scrape all 21 brownie recipes, extract image URLs, generate import-ready JSON
**Depends on**: Phase 16
**Research**: Unlikely (pattern established)
**Plans**: 2 plans

Plans:
- [x] 20-01: Scrape Brownies
- [x] 20-02: Generate JSON + Images

**Details:**
- Scraped 21 brownie recipes
- Generated brownies-import.json with proper markdown formatting
- Created brownies-images.json with image URL mappings

### Phase 21: Import & Verification

**Goal**: Import all JSON files via Settings, verify recipes display correctly
**Depends on**: Phases 17-20
**Research**: Unlikely (using existing import feature)
**Plans**: 2 plans

Plans:
- [x] 21-01: Import All Batches
- [x] 21-02: Verify & Fix Issues

**Details:**
- Imported all 105 recipes via Settings > Import Meals
- Verified folder structure: Broma > Bars, Brownies, Cookies, Muffins
- Confirmed markdown rendering for all recipes

### Phase 22: Recipe Image Upload

**Goal**: Add images to imported recipes using Firestore script
**Depends on**: Phase 21
**Research**: Unlikely (using existing image upload feature)
**Plans**: 1 plan

Plans:
- [x] 22-01: Image Upload Workflow

**Details:**
- Created update-recipe-images.ts Firestore script
- Populated 42 recipes with external Broma Bakery image URLs
- Cookies/bars received images via manual upload (63 recipes)

### Phase 22.1: Paste Image URL Option (INSERTED)

**Goal**: Add ability to paste external image URLs as recipe photos
**Depends on**: Phase 22
**Research**: Unlikely (UI enhancement)
**Plans**: 1 plan

Plans:
- [x] 22.1-01: URL Input in Modals

**Details:**
- Added mode toggle in Add/Edit Meal modals (Upload File / Paste URL)
- URL validation with image load preview
- Direct URL storage without Firebase re-upload
- Gap closure for v1.3 audit pending todo

---

## Milestone Summary

**Decimal Phases:**
- Phase 22.1: Paste Image URL (inserted after Phase 22 for gap closure)

**Key Decisions:**

| Decision | Rationale |
|----------|-----------|
| WebSearch before WebFetch | Recipe URLs may 404; validate first |
| PowerShell clipboard for JSON | Preserves format perfectly |
| External URLs for images | Simpler than re-uploading to Firebase Storage |
| Mode toggle for URL input | Clear visual indication, easy switching |

**Issues Resolved:**

- Recipe markdown numbered list formatting (avoid bold colon pattern)
- Image storage inconsistency (accepted as tech debt)

**Issues Deferred:**

- None

**Technical Debt Incurred:**

- Mixed image storage: Cookies/bars use Firebase Storage, muffins/brownies use external URLs
- Script only automated muffins/brownies; cookies/bars uploaded manually

---

*For current project status, see .planning/ROADMAP.md*

---
*Archived: 2026-01-19 as part of v1.3 milestone completion*
