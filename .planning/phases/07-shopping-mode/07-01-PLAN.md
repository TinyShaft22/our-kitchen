---
phase: 07-shopping-mode
plan: 01
type: execute
---

<objective>
Add store filtering and item interaction to enable shopping mode.

Purpose: Let users filter grocery list by store and tap items to mark as in-cart while shopping.
Output: GroceryListPage with store filter pills and tappable GroceryItemCards.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context (grocery generation):
@.planning/phases/06-grocery-generation/06-02-SUMMARY.md

# Key source files:
@src/pages/GroceryListPage.tsx
@src/components/grocery/GroceryItemCard.tsx
@src/hooks/useGroceryList.ts
@src/types/index.ts

**Tech stack available:** React, Tailwind v4, Firebase/Firestore, existing hooks
**Established patterns:**
- Category grouping with CATEGORIES constant
- FAB positioned bottom-24
- 44px min touch targets
- terracotta/sage badge colors

**Constraining decisions:**
- Phase 06-02: Category-grouped list display pattern
- Phase 04-01: Emoji icons for buttons
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add store filter pills to GroceryListPage</name>
  <files>src/pages/GroceryListPage.tsx</files>
  <action>
Add horizontal scrollable store filter pills below the page title:
1. Add `selectedStore` state: `useState<Store | 'all'>('all')`
2. Create filter row with pills: "All" + each store from STORES constant
3. Style pills:
   - Active: `bg-terracotta text-white`
   - Inactive: `bg-white text-charcoal border border-charcoal/20`
   - All pills: `px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap min-h-[44px]`
4. Wrap in horizontal scroll container: `flex gap-2 overflow-x-auto pb-2 -mx-4 px-4` (negative margin for edge-to-edge scroll)
5. Filter `groupedItems` by selectedStore (if not 'all', filter items where item.store === selectedStore)
6. Update item count display to show filtered count

Keep existing category grouping logic - just filter items before grouping.
  </action>
  <verify>
npm run build succeeds, no TypeScript errors.
Manual: Filter pills appear, tapping filters the list.
  </verify>
  <done>
- Store filter pills render below title
- "All" shows all items, store pills filter to that store
- Active pill has terracotta background
- Item count updates when filtered
  </done>
</task>

<task type="auto">
  <name>Task 2: Add tap-to-toggle in-cart on GroceryItemCard</name>
  <files>src/components/grocery/GroceryItemCard.tsx, src/pages/GroceryListPage.tsx</files>
  <action>
Update GroceryItemCard to be tappable and show in-cart state:

1. In GroceryItemCard.tsx:
   - Add props: `onToggleInCart?: () => void`
   - Make entire card clickable: wrap in button or add onClick to outer div
   - Add cursor-pointer class
   - Conditional styling for in-cart state (item.status === 'in-cart'):
     - Name: `line-through text-charcoal/50`
     - Add checkmark icon before name: âœ“
     - Card background: `bg-sage/10` instead of `bg-white`

2. In GroceryListPage.tsx:
   - Import updateStatus from useGroceryList
   - Pass onToggleInCart to each GroceryItemCard:
     ```tsx
     onToggleInCart={() => updateStatus(
       item.id,
       item.status === 'in-cart' ? 'need' : 'in-cart'
     )}
     ```

Touch target already meets 44px minimum (min-h-[44px] on card).
  </action>
  <verify>
npm run build succeeds.
Manual: Tap item toggles checkmark and strikethrough styling.
  </verify>
  <done>
- Tapping item toggles between 'need' and 'in-cart' status
- In-cart items show: checkmark, strikethrough name, sage background
- Status persists in Firestore (real-time sync)
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Store filter pills appear and filter correctly
- [ ] Tapping items toggles in-cart status
- [ ] In-cart styling is visually distinct
- [ ] Status changes persist (refresh page, still marked)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Store filtering works for all 4 stores + "All"
- Item tap interaction responsive and persisted
</success_criteria>

<output>
After completion, create `.planning/phases/07-shopping-mode/07-01-SUMMARY.md`
</output>
