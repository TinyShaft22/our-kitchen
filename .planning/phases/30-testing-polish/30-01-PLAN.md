---
phase: 30-testing-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/30-testing-polish/30-TEST-CHECKLIST.md
autonomous: true

must_haves:
  truths:
    - "All deployments (Cloud Functions + Lambda) are current"
    - "Test checklist document exists with comprehensive scenarios"
    - "Test data is prepared in the app (meals, groceries, household items)"
  artifacts:
    - path: ".planning/phases/30-testing-polish/30-TEST-CHECKLIST.md"
      provides: "Structured manual test scenarios"
      min_lines: 150
  key_links:
    - from: "30-TEST-CHECKLIST.md"
      to: "Echo Show 5 testing"
      via: "Human executes checklist"
      pattern: "voice command|expected|tap"
---

<objective>
Prepare for Alexa testing by deploying latest code, creating a structured test checklist, and ensuring test data exists.

Purpose: Set up everything needed for comprehensive manual testing on Echo Show 5
Output: Deployed skill, test checklist document, confirmed test data
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-grocery-integration/29-02-SUMMARY.md
@.planning/phases/32-household-items/32-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Deploy Cloud Functions and Lambda</name>
  <files>functions/, our-kitchen-alexa/lambda/</files>
  <action>
Deploy all current code to ensure testing uses latest implementation:

1. **Cloud Functions deployment:**
   ```bash
   cd functions && npm run build && firebase deploy --only functions
   ```

2. **Alexa Lambda deployment:**
   The Lambda is Alexa-hosted, so deployment happens via git push:
   ```bash
   cd our-kitchen-alexa
   git add .
   git commit -m "deploy: prepare for E2E testing"
   git push
   ```

3. **Verify both deployments:**
   - Check Firebase Functions console shows recent deploy time
   - Check Alexa Developer Console > Your Skill > Code tab shows recent deploy

NOTE: If Lambda git repo doesn't exist yet, user needs to pull it from Alexa-hosted:
```bash
ask init --hosted-skill-id [SKILL_ID]
```
  </action>
  <verify>
- `firebase deploy --only functions` completes successfully
- `git push` in our-kitchen-alexa succeeds (or was already deployed)
- No build errors in either deployment
  </verify>
  <done>Both Cloud Functions and Alexa Lambda are deployed with latest code</done>
</task>

<task type="auto">
  <name>Task 2: Create comprehensive test checklist</name>
  <files>.planning/phases/30-testing-polish/30-TEST-CHECKLIST.md</files>
  <action>
Create a structured manual test checklist covering all Alexa capabilities. Format for easy use during hands-on Echo Show testing.

**Document structure:**

```markdown
# Alexa End-to-End Test Checklist

## Test Environment
- Device: Echo Show 5
- Invocation: "Alexa, open our kitchen"
- PWA: [app URL]
- Household PIN: [user's PIN]

## Prerequisites
Before testing, ensure:
- [ ] Cloud Functions deployed
- [ ] Lambda deployed
- [ ] At least 2 meals in weekly plan
- [ ] At least 3 items on grocery list (from different stores)
- [ ] At least 1 saved household item
- [ ] Alexa skill is in development mode

## Test Scenarios

### 1. Household Linking
| # | Voice Command | Expected Response | APL Display | Pass? |
|---|---------------|-------------------|-------------|-------|
| 1.1 | "Alexa, open our kitchen" (unlinked) | Asks for PIN | None | [ ] |
| 1.2 | Say your 4-digit PIN | "Linked to household X" | None | [ ] |
| 1.3 | "Alexa, open our kitchen" (linked) | Welcome back message | None | [ ] |

### 2. Meal Browsing
| # | Voice Command | Expected Response | APL Display | Pass? |
|---|---------------|-------------------|-------------|-------|
| 2.1 | "What's for dinner this week" | Lists weekly meals | Meal list with images | [ ] |
| 2.2 | "Show me baking" | Lists baking recipes | Meal list filtered | [ ] |
| 2.3 | "Show me cookies" | Lists cookie recipes | Meal list filtered | [ ] |
| 2.4 | Tap a meal on screen | Navigates to recipe | Recipe detail | [ ] |

### 3. Recipe Detail
| # | Voice Command | Expected Response | APL Display | Pass? |
|---|---------------|-------------------|-------------|-------|
| 3.1 | "Recipe for [meal name]" | Reads recipe info | Recipe with ingredients | [ ] |
| 3.2 | "What's in [meal name]" | Lists ingredients | Recipe detail | [ ] |
| 3.3 | Tap "Start Cooking" | Enters cooking mode | Cooking step 1 | [ ] |
| 3.4 | Tap back button | Returns to meal list | Meal list | [ ] |

### 4. Cooking Mode - Voice Navigation
| # | Voice Command | Expected Response | APL Display | Pass? |
|---|---------------|-------------------|-------------|-------|
| 4.1 | "Let's cook [meal]" | Step 0 (ingredients) | Pager on ingredients | [ ] |
| 4.2 | "Next" | Reads next step | Pager advances | [ ] |
| 4.3 | "Previous" | Reads previous step | Pager goes back | [ ] |
| 4.4 | "Repeat" | Repeats current step | No change | [ ] |
| 4.5 | Navigate to last step | "Enjoy your meal" | Last step shown | [ ] |
| 4.6 | "Stop" or "Exit" | Exits cooking mode | Returns to recipe | [ ] |

### 5. Cooking Mode - Touch Navigation
| # | Touch Action | Expected Behavior | Pass? |
|---|--------------|-------------------|-------|
| 5.1 | Swipe left | Advances to next step | [ ] |
| 5.2 | Swipe right | Goes to previous step | [ ] |
| 5.3 | Say "Next" after swipe | Voice syncs with swipe position | [ ] |

### 6. Cooking Resume
| # | Action | Expected Response | Pass? |
|---|--------|-------------------|-------|
| 6.1 | Exit cooking mid-recipe, then "open our kitchen" | "Continue cooking X at step Y?" | [ ] |
| 6.2 | "Yes" to resume prompt | Resumes at saved step | [ ] |
| 6.3 | "No" to resume prompt | Starts fresh | [ ] |

### 7. Grocery List - Reading
| # | Voice Command | Expected Response | APL Display | Pass? |
|---|---------------|-------------------|-------------|-------|
| 7.1 | "What's on the grocery list" | Lists items with stores | Grocery list grouped | [ ] |
| 7.2 | "What do I need at Costco" | Lists only Costco items | Filtered list | [ ] |
| 7.3 | "What do I need at Trader Joes" | Lists only TJ items | Filtered list | [ ] |

### 8. Grocery List - Adding
| # | Voice Command | Expected Response | Pass? |
|---|---------------|-------------------|-------|
| 8.1 | "Add eggs" (new item) | "Added eggs. Say undo..." | [ ] |
| 8.2 | "Undo" | "Removed eggs" | [ ] |
| 8.3 | "Add [saved household item]" | Uses saved store/category | [ ] |
| 8.4 | "Add [item already on list]" | "Already have X. Add duplicate?" | [ ] |
| 8.5 | "Yes" to duplicate prompt | Adds duplicate | [ ] |
| 8.6 | "No" to duplicate prompt | Cancels add | [ ] |

### 9. Grocery List - Removing
| # | Voice Command | Expected Response | Pass? |
|---|---------------|-------------------|-------|
| 9.1 | "Remove eggs from the list" | "Removed eggs" | [ ] |
| 9.2 | "Check off milk" | "Checked off milk" | [ ] |

### 10. APL Visual Quality
| # | Check | Expected | Pass? |
|---|-------|----------|-------|
| 10.1 | Colors | Dark theme, terracotta accent | [ ] |
| 10.2 | Text readability | Clear on Echo Show 5 screen | [ ] |
| 10.3 | Scrolling | Smooth, responsive | [ ] |
| 10.4 | Touch targets | Easy to tap | [ ] |

## Issues Found
| # | Description | Severity | Notes |
|---|-------------|----------|-------|
| | | | |

## Test Results Summary
- Total tests: XX
- Passed: XX
- Failed: XX
- Blocked: XX
```
  </action>
  <verify>
- 30-TEST-CHECKLIST.md exists in .planning/phases/30-testing-polish/
- Document has 10+ test categories
- Each category has specific voice commands and expected outcomes
- APL display expectations included where relevant
  </verify>
  <done>Comprehensive test checklist document created with 40+ test scenarios</done>
</task>

<task type="auto">
  <name>Task 3: Verify test data exists in app</name>
  <files>N/A (verification only)</files>
  <action>
Check the PWA has adequate test data. If user reports data is missing, provide quick setup instructions.

**Required test data:**
1. **Weekly meals (2+):** Check Home page shows planned meals
2. **Grocery items (3+ from different stores):** Check Groceries page has items from Costco, Trader Joes, etc.
3. **Household items (1+):** Check Groceries page > Household Items section has saved items like "Paper Towels"
4. **Recipe with instructions (1+):** At least one meal has cooking instructions for cooking mode testing

**If missing, provide setup guide:**
- Add a meal to weekly plan via Load Meals modal
- Add grocery items via FAB or voice
- Add household item via Manage Household Items button
- Ensure at least one baking recipe has step-by-step instructions

The test preparation is complete when user confirms data exists OR user adds required data.
  </action>
  <verify>
User confirms:
- [ ] At least 2 meals in weekly plan
- [ ] At least 3 grocery items from different stores
- [ ] At least 1 saved household item
- [ ] At least 1 recipe with cooking instructions
  </verify>
  <done>Test data confirmed present or user has added required data</done>
</task>

</tasks>

<verification>
- Cloud Functions and Lambda deployed successfully
- 30-TEST-CHECKLIST.md exists and is comprehensive
- User has confirmed test data is ready
</verification>

<success_criteria>
- All deployments complete without errors
- Test checklist covers all Alexa capabilities (linking, meals, cooking, groceries)
- Test data prerequisites met
- Ready for hands-on Echo Show 5 testing in plan 30-02
</success_criteria>

<output>
After completion, create `.planning/phases/30-testing-polish/30-01-SUMMARY.md`
</output>
