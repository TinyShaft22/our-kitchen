---
phase: 09-baking-corner
plan: 03
type: execute
---

<objective>
Integrate baking essentials with grocery list - restock functionality.

Purpose: Allow restocking low/out baking items directly to the grocery list with one tap.
Output: Individual restock buttons, bulk restock action, visual feedback, grocery integration.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context:
@.planning/phases/09-baking-corner/09-02-SUMMARY.md

# Existing code:
@src/types/index.ts
@src/hooks/useBaking.ts
@src/hooks/useGroceryList.ts
@src/pages/BakingPage.tsx
@src/components/baking/BakingEssentialCard.tsx

**Tech stack available:** React, TypeScript, Tailwind, Firebase/Firestore, useBaking + useGroceryList hooks
**Established patterns:** Batch operations, toast/feedback patterns
**Key files:** useGroceryList.addItem for adding to grocery, BakingEssential -> GroceryItem mapping
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add restock button to BakingEssentialCard</name>
  <files>src/components/baking/BakingEssentialCard.tsx</files>
  <action>
Add a "Restock" button to cards that are low or out of stock.

**Button placement:**
- Show only when status is 'low' or 'out'
- Position: right side of card, next to status badge (or below actions)
- Style: small button, terracotta/honey bg, "Restock" text or shopping cart emoji

**Props addition:**
- onRestock: () => void

**Visual:**
- Button text: "Add to List" or cart emoji + "Restock"
- Disabled state while restocking (prevent double-tap)
- After restock, could briefly show checkmark

When status is 'stocked', hide the restock button entirely.
  </action>
  <verify>Restock button appears only on low/out items, triggers onRestock callback</verify>
  <done>BakingEssentialCard shows restock button for low/out items</done>
</task>

<task type="auto">
  <name>Task 2: Implement restock logic in BakingPage</name>
  <files>src/pages/BakingPage.tsx</files>
  <action>
Wire up restock functionality to add items to grocery list.

**Import useGroceryList:**
- Get addItem function from useGroceryList hook

**Restock single item handler:**
Create handleRestock(essential: BakingEssential):
1. Create grocery item from baking essential:
   - name: essential.name
   - qty: essential.qty
   - unit: essential.unit
   - category: 'baking' (hardcoded, matches CATEGORIES)
   - store: 'safeway' (default, or could ask user)
   - status: 'need'
   - source: 'manual' (or add new source 'baking' to types)
2. Call addItem with grocery item
3. Show success feedback (simple alert or toast)
4. Optionally update baking item status to 'stocked'

**Pass handler to card:**
- onRestock={() => handleRestock(essential)}

**Feedback:**
- Simple: window.alert("Added to grocery list!")
- Better: inline "Added!" text that fades after 2 seconds
  </action>
  <verify>Tapping restock adds item to grocery list, feedback shown</verify>
  <done>Individual baking items can be restocked to grocery list</done>
</task>

<task type="auto">
  <name>Task 3: Add bulk restock action for all low/out items</name>
  <files>src/pages/BakingPage.tsx</files>
  <action>
Add a "Restock All" button when there are low/out items.

**Button placement:**
- Show in header area when lowStockItems.length > 0
- Text: "Restock {count} items" or "Add {count} to list"
- Style: terracotta button, prominent

**Bulk restock handler:**
Create handleRestockAll():
1. Get lowStockItems from useBaking
2. For each item, create grocery item and add
3. Use Promise.all for batch operation
4. Show feedback: "Added {count} items to grocery list"
5. Optionally mark all as 'stocked'

**UI considerations:**
- Button disabled while restocking
- Loading indicator during operation
- Count updates after restock (should show 0 low/out)

**Empty state update:**
When all items stocked, hide the bulk restock button.
  </action>
  <verify>Bulk restock adds all low/out items to grocery, count updates</verify>
  <done>Bulk restock functionality works for all low/out items</done>
</task>

<task type="auto">
  <name>Task 4: Add 'baking' source to GroceryItem type (optional enhancement)</name>
  <files>src/types/index.ts</files>
  <action>
Add 'baking' as a source type for grocery items to track origin.

**Update GrocerySource type:**
- Add 'baking' to the union: 'meal' | 'manual' | 'quick-add' | 'staple' | 'baking'

This allows filtering/identifying items that came from baking restock.
  </action>
  <verify>TypeScript compiles, 'baking' source available</verify>
  <done>GrocerySource includes 'baking' option</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Restock button appears on low/out cards only
- [ ] Tapping restock adds single item to grocery list
- [ ] Success feedback shown after restock
- [ ] Bulk "Restock All" button appears when low/out items exist
- [ ] Bulk restock adds all items to grocery
- [ ] Items appear in grocery list with correct data (name, qty, unit, category)
- [ ] Optional: items marked 'stocked' after restock
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Baking items can be restocked individually or in bulk
- Grocery list correctly receives restocked items
</success_criteria>

<output>
After completion, create `.planning/phases/09-baking-corner/09-03-SUMMARY.md`
</output>
