---
phase: 11-simplify-ingredients
plan: 01
type: execute
---

<objective>
Simplify the Ingredient interface by removing qty/unit fields, making meal ingredients just a name with category and store.

Purpose: Reduce friction when adding meals - users don't need to specify quantities for every ingredient. The app becomes about "what do I need" not "how much."
Output: Updated types, simplified IngredientInput component, updated modals, updated grocery generation logic.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Current types to modify:**
@src/types/index.ts

**Current ingredient input:**
@src/components/meals/IngredientInput.tsx

**Modals using IngredientInput:**
@src/components/meals/AddMealModal.tsx
@src/components/meals/EditMealModal.tsx

**Grocery generation to simplify:**
@src/utils/generateGroceryItems.ts

**Key insight:**
- `Ingredient` (in meals) will become simpler: name, category, defaultStore
- `GroceryItem` keeps qty/unit for manual additions, staples, and baking restocks
- `GroceryItemInput` simplifies to match new Ingredient structure
- Meal-sourced grocery items default to qty=1, unit='item'
</context>

<tasks>

<task type="auto">
  <name>Task 1: Simplify Ingredient type and update IngredientInput component</name>
  <files>src/types/index.ts, src/components/meals/IngredientInput.tsx</files>
  <action>
1. In src/types/index.ts, update Ingredient interface:
   - Remove `qty: number`
   - Remove `unit: string`
   - Keep: name, category, defaultStore

2. In src/components/meals/IngredientInput.tsx:
   - Remove Row 2 (qty and unit inputs entirely)
   - Keep Row 1 (name + remove button)
   - Keep Row 3 (category + store selects)
   - Update handleChange to only handle remaining fields
   - Result: 2-row component instead of 3-row
  </action>
  <verify>TypeScript compiles without errors: npm run build</verify>
  <done>Ingredient interface has only name/category/defaultStore. IngredientInput shows name, category, and store inputs only.</done>
</task>

<task type="auto">
  <name>Task 2: Update AddMealModal and EditMealModal default ingredient</name>
  <files>src/components/meals/AddMealModal.tsx, src/components/meals/EditMealModal.tsx</files>
  <action>
1. In AddMealModal.tsx, update createDefaultIngredient():
   - Remove qty: 1
   - Remove unit: ''
   - Keep: name: '', category: 'produce', defaultStore: 'safeway'

2. In EditMealModal.tsx, find any similar default ingredient creation and update the same way.
   - Also check if there's inline ingredient creation that needs updating
  </action>
  <verify>npm run build succeeds, dev server loads meal library page without errors</verify>
  <done>Both modals create ingredients without qty/unit fields.</done>
</task>

<task type="auto">
  <name>Task 3: Update generateGroceryItems to work without qty/unit</name>
  <files>src/utils/generateGroceryItems.ts, src/hooks/useGroceryList.ts</files>
  <action>
1. In generateGroceryItems.ts:
   - Remove scaling logic (no more scaleFactor calculation)
   - Remove qty-based deduplication key (just use lowercased name)
   - Each ingredient becomes a grocery item with qty=1, unit='item'
   - Deduplication: same name = same item (don't add duplicate entries)
   - Keep category and store mapping

2. Update GroceryItemInput interface to match simplified input:
   - Keep: name, category, store
   - The qty/unit will be added by generateGroceryItems as defaults

3. In useGroceryList.ts:
   - Update generateFromWeeklyPlan to add qty: 1, unit: 'item' when creating grocery items from meal ingredients
   - This ensures GroceryItem in Firestore still has qty/unit for display consistency

Note: GroceryItem type keeps qty/unit because:
- Manual quick-adds may specify qty
- Staples have qty: 1, unit: 'item'
- Baking restocks have qty: 1, unit: 'item'
- Shopping mode displays qty
  </action>
  <verify>npm run build succeeds. Create test meal with ingredients, add to weekly plan, generate grocery list - items appear with qty=1.</verify>
  <done>Grocery generation works without ingredient qty/unit. All meal-sourced items appear as qty=1, unit='item'.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without TypeScript errors
- [ ] `npm run dev` starts without console errors
- [ ] Can add a new meal with ingredients (name/category/store only)
- [ ] Can edit existing meal ingredients
- [ ] Generate grocery list from weekly plan works
- [ ] Generated items show qty=1 in grocery list
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Ingredient interface simplified to name/category/defaultStore
- IngredientInput UI is simpler (2 rows instead of 3)
- Grocery generation produces items without relying on ingredient qty/unit
</success_criteria>

<output>
After completion, create `.planning/phases/11-simplify-ingredients/11-01-SUMMARY.md`:

# Phase 11-01 Summary: Simplify Ingredients

**[One-liner: what shipped]**

## Accomplishments
- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified
- `path/to/file.ts` - Description

## Decisions Made
[Key decisions and rationale, or "None"]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
[Ready for Phase 12 or additional Phase 11 plans]
</output>
