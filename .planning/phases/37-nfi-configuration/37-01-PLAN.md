---
phase: 37-nfi-configuration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - our-kitchen-alexa/skill-package/interactionModels/custom/en-US.json
  - our-kitchen-alexa/skill-package/skill.json
autonomous: false

must_haves:
  truths:
    - "Interaction model contains _nameFreeInteraction container with LAUNCH and INTENT ingress points"
    - "NFI phrases are slot-free, natural, complete sentences"
    - "Skill manifest has Lifestyle category and updated description"
    - "Skill builds successfully with NFI container via ASK CLI"
  artifacts:
    - path: "our-kitchen-alexa/skill-package/interactionModels/custom/en-US.json"
      provides: "NFI ingress points configuration"
      contains: "_nameFreeInteraction"
    - path: "our-kitchen-alexa/skill-package/skill.json"
      provides: "Updated skill metadata for store listing"
      contains: "LIFESTYLE"
  key_links:
    - from: "en-US.json _nameFreeInteraction"
      to: "existing intents in languageModel"
      via: "intent name references in INTENT ingress points"
      pattern: "BrowseMealsIntent|ReadGroceryListIntent|StartCookingIntent"
---

<objective>
Configure Name-Free Interaction (NFI) toolkit by adding the _nameFreeInteraction container to the interaction model JSON with skill-level launch phrases and intent-level phrases for standalone intents. Update skill manifest with Lifestyle category and store listing description. Deploy and verify build.

Purpose: Enable Alexa to route utterances to Our Kitchen without explicit invocation name ("Alexa, ask kitchen helper...")
Output: Updated interaction model with NFI config, updated skill manifest, successful deployment
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/37-nfi-configuration/37-CONTEXT.md
@.planning/phases/37-nfi-configuration/37-RESEARCH.md
@our-kitchen-alexa/skill-package/interactionModels/custom/en-US.json
@our-kitchen-alexa/skill-package/skill.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add NFI container and update skill manifest</name>
  <files>
    our-kitchen-alexa/skill-package/interactionModels/custom/en-US.json
    our-kitchen-alexa/skill-package/skill.json
  </files>
  <action>
    1. Read the existing en-US.json interaction model.

    2. Add a `_nameFreeInteraction` container at the same level as `languageModel` inside `interactionModel`. Include these ingress points:

    **LAUNCH ingress (skill-level, up to 5 phrases):**
    - "what should I cook tonight"
    - "help me plan dinner"
    - "I need a recipe"
    - "what's for dinner"
    - "plan my meals for the week"

    **INTENT ingress points (3-5 phrases each, slot-free):**

    BrowseMealsIntent:
    - "show me dinner ideas"
    - "what meals can I make"
    - "suggest something for dinner"

    ReadGroceryListIntent:
    - "read my grocery list"
    - "what's on my shopping list"
    - "check my grocery list"

    AddGroceryIntent:
    - "add something to my grocery list"
    - "I need to add to my shopping list"
    - "put something on my grocery list"

    StartCookingIntent:
    - "start cooking"
    - "guide me through a recipe"
    - "walk me through cooking"

    BrowseCategoryIntent:
    - "show me baking recipes"
    - "what chicken recipes do I have"
    - "browse my recipe categories"

    GetRecipeIntent:
    - "how do I make that recipe"
    - "show me a recipe"
    - "I want to cook something"

    **Skip these intents** (context-dependent, not good NFI entry points):
    - CheckOffGroceryIntent, UndoGroceryIntent, RemoveGroceryIntent, MarkAsLowIntent

    Each utterance uses format: `{"format": "RAW_TEXT", "value": "..."}`. No slots allowed.

    3. Read skill.json manifest. Update:
    - Set `publishingInformation.category` to `"ALARMS_AND_CLOCKS"` if not already set -- actually use `"LIFESTYLE"` per user decision. Check the manifest for the correct field path (`manifest.publishingInformation.locales.en-US`).
    - Update `summary` to position as a kitchen companion: "Plan meals, browse recipes, manage your grocery list, and cook step-by-step with voice guidance."
    - Update `description` (longer) to cover all features: meal browsing, recipe viewing, cooking mode with step-by-step voice navigation, grocery list management, household items, and hands-free kitchen operation.
    - Add or update `examplePhrases` array (up to 3): ["Alexa, open kitchen helper", "Alexa, ask kitchen helper what's for dinner", "Alexa, ask kitchen helper to read my grocery list"]
    - Ensure `isAvailableWorldwide` is true.

    IMPORTANT: Do NOT add slot references in any NFI phrase. All phrases must be complete natural language sentences without curly brace placeholders.
  </action>
  <verify>
    - `cat en-US.json | python3 -c "import json,sys; d=json.load(sys.stdin); print(len(d['interactionModel']['_nameFreeInteraction']['ingressPoints']))"` shows 7 (1 LAUNCH + 6 INTENT)
    - `cat en-US.json | python3 -c "import json,sys; d=json.load(sys.stdin); [print(p['value']) for ip in d['interactionModel']['_nameFreeInteraction']['ingressPoints'] for p in ip['sampleUtterances']]"` shows all phrases, none containing `{` or `}`
    - `cat skill.json | python3 -c "import json,sys; print(json.load(sys.stdin))"` parses without error
  </verify>
  <done>
    - en-US.json has _nameFreeInteraction with 7 ingress points (1 LAUNCH + 6 INTENT)
    - All NFI phrases are slot-free natural language
    - skill.json has Lifestyle category, updated description, and example phrases
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>NFI configuration added to interaction model and skill manifest updated with store listing metadata. Ready for deployment.</what-built>
  <how-to-verify>
    1. Review the NFI phrases in `our-kitchen-alexa/skill-package/interactionModels/custom/en-US.json` -- check that the `_nameFreeInteraction` section has natural-sounding phrases you'd actually say to Alexa
    2. Review skill description in `our-kitchen-alexa/skill-package/skill.json` -- check that the summary and description accurately represent the skill
    3. If satisfied, say "approved" and Claude will deploy via `ask deploy`
    4. If you want phrase changes, describe what to modify
  </how-to-verify>
  <resume-signal>Type "approved" to deploy, or describe changes needed</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Deploy and verify build</name>
  <files>
    our-kitchen-alexa/skill-package/interactionModels/custom/en-US.json
    our-kitchen-alexa/skill-package/skill.json
  </files>
  <action>
    1. From the `our-kitchen-alexa/` directory, run `ask deploy` to push the updated interaction model and manifest.
    2. Check build status: `ask smapi get-skill-status --skill-id $(cat .ask/ask-states.json | python3 -c "import json,sys; print(list(json.load(sys.stdin)['profiles']['default']['skillId']  if isinstance(json.load(sys.stdin)['profiles']['default']['skillId'], str) else '')")` -- or simply check the deploy output for success.
    3. If deploy succeeds, verify the model built by checking the output for "Build Succeeded" or similar.
    4. If NFI isolated simulation is available, try: `ask dialog --locale en-US --simulation-type NFI_ISOLATED_SIMULATION` with a test phrase like "what's for dinner". Note: this may not work if skill isn't published yet -- that's expected, just document the result.

    If deploy fails due to NFI validation errors, fix the JSON and retry.
  </action>
  <verify>
    - `ask deploy` completes without errors
    - Interaction model build succeeds (check output or `ask smapi get-skill-status`)
  </verify>
  <done>
    - Skill deployed with NFI configuration
    - Interaction model builds successfully including NFI container
  </done>
</task>

</tasks>

<verification>
- en-US.json contains `_nameFreeInteraction` with LAUNCH and INTENT ingress points
- All NFI phrases are slot-free
- skill.json has Lifestyle category and updated metadata
- `ask deploy` succeeds
- Model build completes without errors
</verification>

<success_criteria>
- NFI container configured with 7 ingress points (1 LAUNCH + 6 INTENT types)
- Skill manifest updated with Lifestyle category and store listing copy
- Deployed and building successfully
- Ready for certification prep (Phase 38)
</success_criteria>

<output>
After completion, create `.planning/phases/37-nfi-configuration/37-01-SUMMARY.md`
</output>
