---
phase: 13-recipe-instructions
plan: 01
type: execute
---

<objective>
Add recipe instructions field to meals with expandable display.

Purpose: Allow Nick and Bella to store cooking instructions with each meal for quick reference while cooking.
Output: Meals can have optional instructions text, viewable in an expandable section on MealCard.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context (meal patterns established):
@.planning/phases/04-meal-library/04-02-SUMMARY.md
@.planning/phases/04-meal-library/04-03-SUMMARY.md

# Key files to modify:
@src/types/index.ts
@src/components/meals/MealCard.tsx
@src/components/meals/AddMealModal.tsx
@src/components/meals/EditMealModal.tsx

**Tech stack available:** React, TypeScript, Tailwind, Firestore
**Established patterns:**
- Modal from bottom pattern for data entry (AddMealModal, EditMealModal)
- Collapsible sections with expand/collapse (Staples, Already Have)
- Toggle switches for boolean fields (isBaking)

**Constraining decisions:**
- Phase 11: Simplified data model approach - keep things minimal
- Phase 4: Established modal patterns for meal CRUD

**Design notes:**
- Instructions are optional (existing meals won't have them)
- Use simple whitespace-preserved text display (no external markdown library needed)
- Expandable section only shows when instructions exist
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add instructions field to Meal type and modals</name>
  <files>src/types/index.ts, src/components/meals/AddMealModal.tsx, src/components/meals/EditMealModal.tsx</files>
  <action>
1. In src/types/index.ts, add `instructions?: string` field to Meal interface (optional to support existing meals).

2. In AddMealModal.tsx:
   - Add `const [instructions, setInstructions] = useState('')`
   - Add textarea field between "Baking Recipe" toggle and "Ingredients Section" with:
     - Label: "Instructions (optional)"
     - Placeholder: "Add cooking steps, tips, or notes..."
     - Min height: 4 rows, resize-y for flexibility
     - Same input styling as other fields (border-charcoal/20, focus:border-terracotta)
   - Include `instructions: instructions.trim() || undefined` in onSave call (omit if empty)
   - Reset instructions in resetForm()

3. In EditMealModal.tsx:
   - Add `const [instructions, setInstructions] = useState(meal.instructions || '')`
   - Add same textarea field as AddMealModal
   - Add instructions to useEffect reset: `setInstructions(meal.instructions || '')`
   - Include `instructions: instructions.trim() || undefined` in onSave call
  </action>
  <verify>npm run build passes with no TypeScript errors</verify>
  <done>Meal type has optional instructions field, both modals have textarea for entering/editing instructions</done>
</task>

<task type="auto">
  <name>Task 2: Add expandable instructions section to MealCard</name>
  <files>src/components/meals/MealCard.tsx</files>
  <action>
Add expandable instructions section to MealCard:

1. Add `const [isExpanded, setIsExpanded] = useState(false)` state

2. After the existing card content (after the flex container with name/actions), add conditional section:
   - Only render if `meal.instructions` exists and is non-empty
   - Show a clickable row with:
     - Text: "üìù Instructions"
     - Chevron indicator: ‚ñº when collapsed, ‚ñ≤ when expanded
     - Full-width touch target (h-10), subtle top border (border-t border-charcoal/10)
   - On click: toggle isExpanded

3. When expanded, show instructions content:
   - Below the clickable row
   - Use `whitespace-pre-wrap` to preserve line breaks
   - Text styling: text-sm text-charcoal/80, padding px-4 pb-4
   - Subtle background: bg-cream/50 rounded-b-soft

4. If meal has no instructions, render nothing extra (card stays as-is)
  </action>
  <verify>npm run dev, create/edit a meal with instructions, verify expandable section appears and toggles correctly</verify>
  <done>MealCard shows expandable "Instructions" section when instructions exist, clicking expands/collapses to show full text</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run dev` works, app loads
- [ ] Can add a new meal with instructions via AddMealModal
- [ ] Can edit existing meal to add/modify instructions via EditMealModal
- [ ] MealCard shows expandable instructions section when present
- [ ] MealCard without instructions looks unchanged (no empty section)
- [ ] Instructions preserve line breaks when displayed
</verification>

<success_criteria>

- Meal type extended with optional instructions field
- Both Add and Edit modals support instructions textarea
- MealCard displays instructions in expandable section
- Existing meals without instructions work correctly
- No TypeScript errors or build warnings
</success_criteria>

<output>
After completion, create `.planning/phases/13-recipe-instructions/13-01-SUMMARY.md`
</output>
