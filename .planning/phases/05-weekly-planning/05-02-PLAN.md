---
phase: 05-weekly-planning
plan: 02
type: execute
---

<objective>
Add meals from library to the weekly plan via a selection modal.

Purpose: Enable users to browse their meal library and add meals to this week's plan.
Output: Working AddToWeekModal with FAB trigger on Home page.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:
@.planning/phases/05-weekly-planning/05-01-SUMMARY.md

# Patterns to follow:
@src/components/meals/AddMealModal.tsx
@src/pages/MealLibrary.tsx
@src/components/ui/FloatingActionButton.tsx

**Tech stack available:** React, TypeScript, Tailwind, Firebase/Firestore
**Established patterns:**
- Bottom-sheet modal pattern from AddMealModal
- FloatingActionButton for primary action
- useMeals provides meals array for selection
- useWeeklyPlan provides addMealToWeek(mealId, servings)

**Constraining decisions:**
- [04-02]: Bottom-sheet modal pattern (slides up from bottom)
- [04-02]: 44px touch targets for mobile
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AddToWeekModal component</name>
  <files>src/components/planning/AddToWeekModal.tsx</files>
  <action>
Create modal for selecting a meal to add to the weekly plan:
1. Props: isOpen, onClose, meals (Meal[]), onAdd (mealId: string, servings: number) => Promise<void>
2. Same bottom-sheet styling as AddMealModal (fixed inset-0, bg-black/50 backdrop, slide-up white panel)
3. Header: "Add Meal to Week" with X close button
4. Scrollable list of meals from props (max-h with overflow-y-auto)
5. Each meal row: name, current default servings, tap to select
6. When meal tapped: show servings input (number, default to meal.servings)
7. Confirm button to call onAdd with mealId and servings
8. Close modal on successful add
9. Handle empty meals state: "No meals in library. Add some first!"
  </action>
  <verify>TypeScript compiles, component exports correctly</verify>
  <done>AddToWeekModal component with meal selection list and servings input</done>
</task>

<task type="auto">
  <name>Task 2: Wire AddToWeekModal to Home page</name>
  <files>src/pages/Home.tsx</files>
  <action>
Add the modal and FAB to Home page:
1. Import FloatingActionButton and AddToWeekModal
2. Add isAddModalOpen state (useState false)
3. Add handleAddClick to open modal
4. Add handleCloseModal to close modal
5. Add handleAddMealToWeek async function that calls addMealToWeek from useWeeklyPlan
6. Render FloatingActionButton with onClick={handleAddClick}, ariaLabel="Add meal to week"
7. Render AddToWeekModal with isOpen, onClose, meals from useMeals, onAdd handler
8. After successful add, modal closes automatically
  </action>
  <verify>npm run dev, Home page shows FAB, clicking opens modal, can select meal and add to week</verify>
  <done>FAB on Home opens AddToWeekModal, selecting meal adds it to weekly plan</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] FAB visible on Home page (bottom-right, above nav)
- [ ] Clicking FAB opens AddToWeekModal
- [ ] Modal shows list of meals from library
- [ ] Selecting meal allows entering servings
- [ ] Confirming add closes modal and meal appears in weekly plan
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Add meal to week flow works end-to-end
- Modal follows established bottom-sheet pattern
</success_criteria>

<output>
After completion, create `.planning/phases/05-weekly-planning/05-02-SUMMARY.md`
</output>
